{% import "header.html" as header %}
<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="icon" href="app_icons/icon.ico">
    <!-- Bootstrap CSS -->
    <link rel="stylesheet"
          href="{{ url_for('static', filename='bootstrap/bootstrap.min.css') }}">
    <link rel="stylesheet"
          href="{{ url_for('static', filename='bootstrap/bootstrap-icons.css') }}">
    <link rel="stylesheet"
          href="{{ url_for('static', filename='css/custom.css') }}">
    <script src="{{ url_for('static', filename='bootstrap/bootstrap.bundle.min.js') }}"></script>
    <script src="{{ url_for('static', filename='jquery.min.js') }}"></script>
    <title>{{ anime.title }}</title>
    <script>
		function updateTag(id, tag) {
			$.ajax({
				type: "POST",
				url: "/anime_info/updateTag?id=" + id,
				data: {
					'tag': tag
				},
				// success: function (e) {
				//   alert(e);
				// }
			});
		}
	
    </script>
  </head>
  <body class="bg-secondary d-flex flex-column vh-100">
    {{ header.render_header(False, url_for('index') ) }}
    <div class="d-flex flex-grow-1">
      <div class="row row-cols-md-2 row-cols-1 gx-3 w-100 mx-0">
        <div class="col d-flex align-items-center justify-content-center mt-3 p-5">
          <img class="shadow-lg bg-light rounded-3 mx-auto my-auto d-block"
               src='{{ anime.picture }}'
               onerror="if (this.src != '{{ url_for('static', filename='NotFound.svg') }}') this.src = '{{ url_for('static', filename='NotFound.svg') }}';"
               alt="Couldn't load the image!">
        </div>
        <div class="col px-4 py-5 mt-3 text-center rounded-start shadow text-light bg-dark">
          <h1 class="display-5 fw-bold mb-4">{{ anime.title }}</h1>
          <div class="btn-group d-none d-sm-block"
               role="group"
               aria-label="Tag buttons H">
            {% for tag in tags %}
              <input type="radio" class="btn-check" name="radio_btn_tag_H" id="btnradioH{{ tag }}" autocomplete="off" onclick="updateTag({{ anime.id }}, '{{ tag }}')" {% if anime.tag == tag %}"checked"{% endif %} value={{ tag }}>
              <label class="btn btn-outline-primary-{{ tag|lower }}"
                     for="btnradioH{{ tag }}">{{ tag }}</label>
            {% endfor %}
          </div>
          <div class="btn-group-vertical d-block d-sm-none"
               role="group"
               aria-label="Tag buttons V">
            {% for tag in tags %}
              <input type="radio" class="btn-check" name="radio_btn_tag_V" id="btnradioV{{ tag }}" autocomplete="off" onclick="updateTag({{ anime.id }}, '{{ tag }}')" {% if anime.tag == tag %}"checked"{% endif %} value={{ tag }}>
              <label class="btn btn-outline-primary-{{ tag }} mt-1"
                     for="btnradioV{{ tag }}">{{ tag }}</label>
            {% endfor %}
          </div>
          <p class="lead mt-4">{{ anime.synopsis }}</p>
          <p class="text-secondary">
            Rating: {{ anime.rating or '?' }}
            <br class="d-sm-none d-inline" />
              <span class="d-sm-inline d-none">-</span>
            {{ anime.episodes or 'No' }} episode {{- 's' if anime.episodes == None or anime.episodes > 1 else '' }}
            {% if anime.duration %}
              ({{ anime.duration }} min{{ " each" if anime.episodes > 1 else "" }})
            {% endif %}
          </p>
          <p class="text-secondary">{{ anime|GetStatusText|safe }}</p>
        </div>
      </div>
    </div>
  </body>
</html>
